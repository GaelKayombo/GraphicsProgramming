<!DOCTYPE html>
<html>
<head>
    <title>Lab 4 - Paddle and Ball</title>
</head>
<body>
    <canvas id="gameCanvas" width="800" height="600" style="border:1px solid black;"></canvas>
    <script>
        // Setup canvas and context
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        // Ball and paddle setup
        let ball = { x: 400, y: 300, radius: 10, dx: 3, dy: -3, color: "blue" };
        let paddle = { x: 370, y: 580, radius: 30, color: "green" };
        let collisionCount = 0; // Keep track of collisions

        // Draw the paddle (circle now)
        function drawPaddle() {
            ctx.beginPath();
            ctx.arc(paddle.x, paddle.y, paddle.radius, 0, Math.PI * 2);
            ctx.fillStyle = paddle.color;
            ctx.fill();
            ctx.closePath();
        }

        // Draw the ball
        function drawBall() {
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
            ctx.fillStyle = ball.color;
            ctx.fill();
            ctx.closePath();
        }

        // Detect collision between ball and paddle
        function detectCollision() {
            const distX = ball.x - paddle.x;
            const distY = ball.y - paddle.y;
            const distance = Math.sqrt(distX * distX + distY * distY);

            if (distance < ball.radius + paddle.radius) {
                ball.dy = -ball.dy; // Bounce the ball
                collisionCount++; // Increment collision count
            }
        }

        // Display collision count
        function displayCollisionCount() {
            ctx.font = "20px Arial";
            ctx.fillStyle = "black";
            ctx.fillText("Collisions: " + collisionCount, 10, 20); // Top-left corner
        }

        // Update everything
        function update() {
            ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear canvas
            drawPaddle();
            drawBall();
            displayCollisionCount();
            detectCollision();

            // Move the ball
            ball.x += ball.dx;
            ball.y += ball.dy;

            // Ball-wall collisions
            if (ball.x + ball.dx > canvas.width - ball.radius || ball.x + ball.dx < ball.radius) {
                ball.dx = -ball.dx;
            }
            if (ball.y + ball.dy < ball.radius) {
                ball.dy = -ball.dy;
            }

            // Game over if ball hits the bottom wall
            if (ball.y + ball.dy > canvas.height - ball.radius) {
                console.log("Game Over!"); // Log game over
                document.location.reload(); // Reload page to restart
            }

            requestAnimationFrame(update); // Repeat
        }

        update(); // Start the game loop
    </script>
</body>
</html>
